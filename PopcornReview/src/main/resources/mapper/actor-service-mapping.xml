<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ns.sql.ActorMapper">

    <!-- 공용 ResultMap: 컬럼 ↔ VO 매핑 -->
    <resultMap id="actorRM" type="com.service.popcornreview.vo.Actor">
        <id     property="aId"       column="a_id"/>
        <result property="aName"     column="a_name"/>
        <result property="aPlot"     column="a_plot"/>
        <result property="aUrlImage" column="a_url_image"/>
    </resultMap>

    <!-- 단건 조회: 문자열 aId -->
    <select id="getActor" parameterType="string" resultMap="actorRM">
        SELECT a_id, a_name, a_plot, a_url_image
        FROM actor
        WHERE a_id = #{aId}
    </select>

    <!-- 영화별 배우 조회: column="m_id"로 넘어오는 파라미터명을 그대로 사용 -->
    <select id="getActorsByMovie" parameterType="int" resultMap="actorRM">
        SELECT a.*
        FROM actor a
        JOIN mov_act ma ON a.a_id = ma.a_id
        WHERE ma.m_id = #{m_id}
    </select>

    <!-- 자동완성: 이름 일부 검색 -->
    <select id="searchActorsByName" parameterType="string" resultType="com.service.popcornreview.vo.Actor">
        SELECT a_id, a_name
        FROM actor
        WHERE a_name LIKE CONCAT('%', #{value}, '%')
        LIMIT 10
    </select>

    <!-- 정확 이름으로 단건 -->
    <select id="getActorByName" parameterType="string" resultMap="actorRM">
        SELECT a_id, a_name, a_plot, a_url_image
        FROM actor
        WHERE a_name = #{value}
    </select>

    <!-- (선택) ID로 단건 - 위 getActor와 동일 기능 -->
    <select id="getActorById" parameterType="string" resultMap="actorRM">
        SELECT a_id, a_name, a_plot, a_url_image
        FROM actor
        WHERE a_id = #{aId}
    </select>
</mapper>
